
```{r}
library(dplyr)
data <- read.csv("CA1.csv")

data2 <- filter(data, TimePeriod == 2)
data2 <- data2[, -5]

```



```{r}

par(mfrow = c(2, 2)) 

qqnorm(data2$MaxBreadth, main = "Max Breath")
qqline(data2$MaxBreadth)


qqnorm(data2$BasHeight, main = "Bas Height")
qqline(data2$BasHeight)

qqnorm(data2$BasLength, main = "Bas Length")
qqline(data2$BasLength)

qqnorm(data2$NasHeight, main = "Nas Height")
qqline(data2$NasHeight)

  
```

```{r}
S <- cov(data2)
n <- nrow(data2)

#1. Calculate squared distances
d2 <- mahalanobis(data2, colMeans(data2), cov = S) #Compare with T4_3[, 5]

#2. Order the squared distances
d2_ord <- sort(d2)

qcp <- qchisq((1:n - 0.5)/n, ncol(data2))
plot(qcp, d2_ord, main="Chi-square plot", pch = 16, 
     ylab = '')
title(ylab = expression(d[(j)]^2), line = 2)
abline(a = 0, b = 1, col = 'red')


```











